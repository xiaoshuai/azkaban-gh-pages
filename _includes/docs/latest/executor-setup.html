<h2 id="executor-setup">Set up Azkaban Executor Server</h2>

<p class="lead">Azkaban Executor Server handles the actual execution of the workflow and jobs.</p>

<h3>Installing the Executor Server</h3>

<p>Grab the azkaban-exec-server package from the <a href="{{ site.home }}/downloads.html">downloads page</a>.</p>

<p>Alternatively, you can clone the <a href="https://github.com/azkaban/azkaban2" target="_blank">GitHub repo</a>, you can build the latest version from the master branch. <a href="#building-from-source">See here</a> for instructions on building from source.</p>

<p>Extract the package into a directory. The install path should be different from the Azkaban Web Server. After extraction, there should be the following directories.</p>

<table class="table table-striped table-bordered table-condensed">
  <thead>
    <th>Folder</th>
    <th>Description</th>
  </thead>
  <tbody>
    <tr>
      <td>bin</td>
      <td>The scripts to start Azkaban jetty server</td>
    </tr>
    <tr>
      <td>conf</td>
      <td>The configurations for Azkaban solo server</td>
    </tr>
    <tr>
      <td>lib</td>
      <td>The jar dependencies for Azkaban</td>
    </tr>
    <tr>
      <td>extlib</td>
      <td>Additional jars that are added to extlib will be added to Azkaban's classpath</td>
    </tr>
    <tr>
      <td>plugins</td>
      <td>the directory where plugins can be installed</td>
    </tr>
  </tbody>
</table>

<p>In the <code>conf</code> directory, we only need to configure the <code>azkaban.properties</code> file. </p>
<p>This file is the be the main configuration file that is necessary to setup Azkaban Executor.</p>

<h3>Setting up the DB</h3>

<p>If you haven't gotten the MySQL JDBC driver, you can get it from <a href="http://www.mysql.com/downloads/connector/j/" target="_blank">this link</a>.</p>
<p>Drop this jar into the <code>extlib</code> directory. All external dependencies should be added to the extlib directory.</p>

<p>To point Azkaban web client to the MySQL instance, you will need to add the connection parameters to <code>azkaban.properties</code>.</p>

<pre class="code">
database.type=mysql
mysql.port=3306
mysql.host=localhost
mysql.database=azkaban
mysql.user=azkaban
mysql.password=azkaban
mysql.numconnections=100
</pre>

<p>Currently MySQL is the only data store type supported in Azkaban. So <code>database.type</code> should always be <code>mysql</code>.</p>

<h3>Configuring AzabanWebServer and AzkabanExecutorServer clients</h3>

<p>The Executor server needs to be setup with a port, and the AzabanWebServer will need to know what this port is.</p>
<p>The following properties need to be set on AzkabanExecutorServer's <code>azkaban.properties</code>.</p>

<pre class="code">
# Azkaban Executor settings
executor.maxThreads=50
executor.port=12321
executor.flow.threads=30
</pre>

<h4>Single Executor Mode</h4>
<p>By default the <code>executor.port</code> is set to <code>12321</code>. The AzkabanWebServer will have to point to this port as well.</p>
<p>This is done by setting the following property in AzkabanWebServer's <code>azkaban.properties</code>.</p>
<pre class="code">
executor.port=12321
</pre>

<h4>Multiple Executor Mode</h4>
<p>We need to enable multiple executor mode in webserver configuration if we want to run in multiple executor mode. Please verify that you have following properties in azkaban.properties.
azkaban.use.multiple.executors and azkaban.executorselector.comparator.* are required properties. Please note that <code>azkaban.use.multiple.executors</code> is not honoured in multiple exeutor mode.</p>

<pre class="code">
azkaban.use.multiple.executors=true
azkaban.executorselector.filters=StaticRemainingFlowSize,MinimumFreeMemory,CpuStatus
azkaban.executorselector.comparator.NumberOfAssignedFlowComparator=1
azkaban.executorselector.comparator.Memory=1
azkaban.executorselector.comparator.LastDispatched=1
azkaban.executorselector.comparator.CpuUsage=1
</pre>

<p>These changes are only picked up after restarting the servers.</p>

<h3>Running Executor Server</h3>

<p>Execute <code>bin/azkaban-exec-start.sh</code> to start AzkabanExecutorServer. </p>
<p>To shutdown the AzkabanExecutorServer, run <code>bin/azkaban-exec-shutdown.sh</code></p>
